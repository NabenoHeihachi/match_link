{% extends 'base.html' %}
{% load static %}

{% block title %}
    Matching Method Auto
{% endblock %}


{% block content %}
<div class="card border-0 rounded-0 mb-4 p-2 pt-3 bg-white">
    <div class="card-body overflow-x-auto">
        <h4 class="card-title fs-3 mb-3">
            自動型マッチング
        </h4>
        <p class="card-text mb-4 text-muted px-2">
            マッチングが完了しました。相手のプロフィールを確認後してください。
        </p>
        
        <h4 class="card-title fs-4 mb-3">
            プロフィール
        </h4>
        <div class="">
            <div class="mb-4" style="min-width: 1000px;">
                <div id="carouselMatchingIndicators" class="carousel slide">
                    <div class="carousel-inner" >
                        <div class="carousel-item active" >
                            <img src="{% static 'img/profile/card_bg.png' %}" class="d-block w-100" alt="Card Background" style="min-height: 800px;">
                            <div class="carousel-caption d-block">
                                <div class="card shadow border border-light-subtle rounded-4 overflow-x-hidden overflow-y-scroll my-3" style="max-width: 600px; margin: auto; max-height: 700px;">
                                    <div class="card-body text-center p-4 bg-light">
                                        <img src="{% static candidate_data.profile.profile_image %}" alt="Profile Image"
                                            class="rounded-circle mb-3 shadow" style="width: 160px; height: 160px; object-fit: cover;">
                                        <h4 class="fw-bold mb-1">{{ candidate_data.account.account_name }}</h4>
                                        <p class="text-muted mb-2">メンバー番号: {{ candidate_data.account.member_number }}</p>
                                        <p class="text-muted">{{ candidate_data.profile.age|default:'-' }}歳</p>
                                    </div>

                                    <div class="card-body p-4">
                                        <dl class="row mb-3 text-start overflow-y-scroll" style="max-height: 240px;">
                                            <dt class="col-4 fw-bold text-muted">マッチ度</dt>
                                            <dd class="col-8 overflow-y-scroll" style="max-height: 50px;">
                                                <span class="badge bg-secondary fs-6 ">
                                                    {{ candidate_data.match_score|floatformat:2 }}%
                                                </span>
                                            </dd>

                                            <dt class="col-4 fw-bold text-muted">自己紹介</dt>
                                            <dd class="col-8 overflow-y-scroll" style="max-height: 50px;">
                                                {{ candidate_data.profile.self_introduction|default:'-' }}
                                            </dd>

                                            <dt class="col-4 fw-bold text-muted">役職・所属</dt>
                                            <dd class="col-8 overflow-y-scroll" style="max-height: 50px;">
                                                {{ candidate_data.profile.position|default:'-' }}
                                            </dd>

                                            <dt class="col-4 fw-bold text-muted">最終学歴</dt>
                                            <dd class="col-8 overflow-y-scroll" style="max-height: 50px;">
                                                {{ candidate_data.profile.final_education|default:'-' }}
                                            </dd>

                                            <dt class="col-4 fw-bold text-muted">特技・スキル</dt>
                                            <dd class="col-8 overflow-y-scroll" style="max-height: 50px;">
                                                {{ candidate_data.profile.special_skills|default:'-' }}
                                            </dd>

                                            <dt class="col-4 fw-bold text-muted">一緒に働きたい人物像</dt>
                                            <dd class="col-8 overflow-y-scroll" style="max-height: 50px;">
                                                {{ candidate_data.profile.preferred_partner_description|default:'-' }}
                                            </dd>
                                        </dl>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="my-4 py-2">
            <h4 class="card-title fs-4 mb-3">マッチングサマリー（AI）</h4>
            <p class="p-2 text-muted">{{ ai_reason_summary|default:'-' }}</p>
        </div>

        <div class="my-4 py-2">
            <div class="text-center my-3 mt-4 d-grid gap-2 col-12 col-md-7 mx-auto">
                <a href="{% url 'app_matching:result_detail' result_id %}"
                    class="btn btn-lg btn-primary py-2 px-3 custom-loading-overlay prevent-double-click-button">
                    結果を確認する
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}