<!-- ------------------------ -->
<!-- 概要：プロファイル管理フォームHTML -->
<!-- ------------------------ -->
{% extends 'base.html' %}
{% load static %}
{% block csslink %}

{% endblock %}

{% block title %}
    Profile Management
{% endblock %}

{% block css_js_path %}
{% endblock %}

{% block content %}
<div class="card border-0 rounded-0 mt-3 mb-4 p-2 pt-3 bg-white">
    <div class="card-body overflow-x-auto">
        <h4 class="card-title fs-4 mb-3">
            プロファイル
        </h4>
        
        <div class="my-5 px-3">
            <div class="card shadow border border-light-subtle rounded-4 overflow-x-hidden overflow-y-scroll" style="max-width: 600px; margin: auto;">
                <div class="card-body text-center p-4 bg-light">
                    <img src="{% static profile_obj.profile_image %}" alt="Profile Image"
                        class="rounded-circle mb-3 shadow" style="width: 160px; height: 160px; object-fit: cover;">
                    <h4 class="fw-bold mb-1">{{ request.user.account_name }}</h4>
                    <p class="text-muted mb-2">メンバー番号: {{ request.user.member_number }}</p>
                    <p class="text-muted">{{ profile_obj.age|default:'-' }}歳</p>
                </div>

                <div class="card-body p-4">
                <dl class="row mb-3">
                    <dt class="col-sm-4 fw-bold text-muted">自己紹介</dt>
                    <dd class="col-sm-8 overflow-y-scroll" style="max-height: 50px;">
                        {{ profile_obj.self_introduction|default:'-' }}
                    </dd>

                    <dt class="col-sm-4 fw-bold text-muted">役職・所属</dt>
                    <dd class="col-sm-8 overflow-y-scroll" style="max-height: 50px;">
                        {{ profile_obj.position|default:'-' }}
                    </dd>

                    <dt class="col-sm-4 fw-bold text-muted">最終学歴</dt>
                    <dd class="col-sm-8 overflow-y-scroll" style="max-height: 50px;">
                        {{ profile_obj.final_education|default:'-' }}
                    </dd>

                    <dt class="col-sm-4 fw-bold text-muted">特技・スキル</dt>
                    <dd class="col-sm-8 overflow-y-scroll" style="max-height: 50px;">
                        {{ profile_obj.special_skills|default:'-' }}
                    </dd>

                    <dt class="col-sm-4 fw-bold text-muted">一緒に働きたい人物像</dt>
                    <dd class="col-sm-8 overflow-y-scroll" style="max-height: 50px;">
                        {{ profile_obj.preferred_partner_description|default:'-' }}
                    </dd>
                </dl>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card border-0 rounded-0 mt-3 mb-4 p-2 pt-3 bg-white">
    <div class="card-body overflow-x-auto">
        <h4 class="card-title fs-4 mb-4">
            プロファイル編集
        </h4>
        <p class="text-muted mb-4">
            プロファイル画像と基本情報を更新します。編集後、更新ボタンを押してください。
        </p>
        <form method="post" class="prevent-double-click-form lh-lg">
            {% csrf_token %}

            <p class="mb-1">
                プロファイル画像:
            </p>
            <div class="d-flex flex-wrap gap-3 mb-3">
                {% for choice in profile_image_form.profile_image %}
                <div class="border rounded p-2">
                    <div class="form-check text-center d-flex gap-2 align-items-center">
                        {{ choice.tag }}
                        <label class="form-check-label" for="{{ choice.id_for_label }}">
                            <img src="{% static choice.data.value %}" alt="プロフィール画像"
                                class="img-fluid rounded" style="width: 80px; height: 80px;">
                        </label>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="mb-3">
                {% for field in profile_input_form %}
                <div class="mb-3">
                    {{ field.label_tag }}
                    {{ field }}
                    {% for error in field.errors %}
                    <div class="text-danger small px-3">エラー：{{ error }}</div>
                    {% endfor %}
                </div>
                {% endfor %}
            </div>
            
            <!--  送信ボタン -->
            <div class="text-center my-3 mt-4">
                <button type="submit" 
                    class="btn btn-lg btn-secondary py-2 px-3 prevent-double-click-button">
                    更新する
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}